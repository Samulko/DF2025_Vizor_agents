/* 强调效果 - 检测到数据变化时 */
.emphasis-effect {
    animation: emphasis-pulse 3s ease-in-out;
}

@keyframes emphasis-pulse {
    0% { 
        transform: scale(1); 
        filter: brightness(1);
    }
    25% { 
        transform: scale(1.1); 
        filter: brightness(1.3);
    }
    50% { 
        transform: scale(1.05); 
        filter: brightness(1.2);
    }
    75% { 
        transform: scale(1.1); 
        filter: brightness(1.3);
    }
    100% { 
        transform: scale(1); 
        filter: brightness(1);
    }
}

/* 圆圈基础样式 */
.circle {
    transition: all 0.3s ease-out;
    cursor: pointer;
    /* 增加描边宽度，让圆更明显 */
    stroke-width: 4px;
}

/* 圆圈描边样式 */
.circle-stroke {
    fill: none;
    stroke-width: 4px; /* 增加描边宽度 (之前是2px) */
    stroke-linecap: round;
    transition: all 0.3s ease-out;
}

/* 不同状态的圆圈样式 */
.circle-state-initializing {
    filter: url(#glow);
    animation: pulse-initializing 4s ease-in-out infinite alternate; /* 更慢 (之前是3s) */
    opacity: 0.8;
}

.circle-state-locked {
    filter: url(#flash);
    animation: flash 0.8s ease-out; /* 更慢 (之前是0.5s) */
}

.circle-state-stable {
    filter: url(#glow);
    animation: breathing 5s ease-in-out infinite; /* 更慢 (之前是3.5s) */
}

.circle-state-updating {
    filter: url(#glow);
    animation: update-transition 1.2s ease-out; /* 更慢 (之前是0.8s) */
}

.circle-state-error {
    filter: url(#glow); /* 使用普通发光效果，不是警告发光 */
    animation: error-pulse 2s ease-in-out infinite; /* 更慢 (之前是1s) */
}

/* 数字标签样式 - 更大更粗 */
.label {
    font-family: 'Montserrat', sans-serif;
    font-weight: 900; /* 更粗 (之前是700) */
    text-anchor: middle;
    dominant-baseline: central;
    transition: all 0.2s ease-out;
    pointer-events: none;
    text-shadow: 4px 4px 8px rgba(0, 0, 0, 0.9); /* 更深的阴影 (之前是3px 3px 6px) */
    letter-spacing: 3px; /* 增加字母间距 (之前是2px) */
    /* 增加字体大小 - 响应式，适应更大的圆 */
    font-size: clamp(80px, 8vw, 200px); /* 最小80px，最大200px，默认8vw */
}

.label-state-initializing {
    animation: number-random 0.5s ease-in-out infinite; /* 更慢 (之前是0.3s) */
    opacity: 0.9;
    font-weight: 900; /* 更粗 (之前是800) */
}

.label-state-locked {
    animation: label-flash 0.8s ease-out; /* 更慢 (之前是0.5s) */
}

.label-state-stable {
    /* 静止状态，无动画 */
}

.label-state-updating {
    animation: label-update 0.5s ease-out; /* 更慢 (之前是0.3s) */
}

.label-state-error {
    /* 移除闪烁动画，保持正常显示 */
    /* animation: label-error 2s ease-in-out infinite; */
}

/* 动画定义 */

/* 脉冲动画 - 初始化状态 - 更慢更舒适 */
@keyframes pulse-initializing {
    0% { 
        opacity: 0.6; 
        transform: scale(0.95); 
        filter: brightness(0.9);
    }
    100% { 
        opacity: 1; 
        transform: scale(1.05); 
        filter: brightness(1.1);
    }
}

/* 脉冲动画 - 初始化状态 - 更慢 */
@keyframes pulse {
    0% { opacity: 0.6; transform: scale(0.95); }
    100% { opacity: 1; transform: scale(1.05); }
}

/* 闪光动画 - 锁定状态 - 更慢 */
@keyframes flash {
    0% { opacity: 0.3; transform: scale(0.8); }
    50% { opacity: 1; transform: scale(1.2); }
    100% { opacity: 1; transform: scale(1); }
}

/* 呼吸动画 - 稳定状态 - 更慢更舒适 */
@keyframes breathing {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.02); }
}

/* 更新过渡动画 - 更慢 */
@keyframes update-transition {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
}

/* 错误脉冲动画 - 更慢 */
@keyframes error-pulse {
    0%, 100% { opacity: 0.7; }
    50% { opacity: 1; }
}

/* 数字随机动画 - 初始化状态 - 更慢更舒适 */
@keyframes number-random {
    0% { 
        opacity: 0.8; 
        transform: scale(0.98);
        filter: brightness(0.9);
    }
    50% { 
        opacity: 1; 
        transform: scale(1.02);
        filter: brightness(1.05);
    }
    100% { 
        opacity: 0.8; 
        transform: scale(0.98);
        filter: brightness(0.9);
    }
}

/* 标签闪光动画 - 锁定状态 - 更慢 */
@keyframes label-flash {
    0% { opacity: 0.5; transform: scale(0.9); }
    50% { opacity: 1; transform: scale(1.1); }
    100% { opacity: 1; transform: scale(1); }
}

/* 标签更新动画 - 更慢 */
@keyframes label-update {
    0% { opacity: 0.7; transform: scale(0.95); }
    100% { opacity: 1; transform: scale(1); }
}

/* 标签错误动画 - 更慢 */
@keyframes label-error {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
}

/* 重叠区域效果 */
.circle-overlap {
    mix-blend-mode: screen;
    opacity: 0.7;
}

/* 碰撞效果 */
.collision-effect {
    animation: collision-pulse 0.3s ease-out;
}

@keyframes collision-pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

/* 圆圈动画效果 */
.circle {
    transition: r 0.5s ease-out, opacity 0.3s ease-out;
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
}

.circle:hover {
    filter: drop-shadow(0 6px 12px rgba(0, 0, 0, 0.4));
    transform: scale(1.02);
}

/* 状态相关的重叠效果 */
.overlap-state-initializing {
    animation: overlap-random 1s ease-in-out infinite; /* 更慢 (之前是0.5s) */
}

.overlap-state-stable {
    animation: overlap-stable 6s ease-in-out infinite; /* 更慢 (之前是4s) */
}

.overlap-state-updating {
    animation: overlap-conflict 1.2s ease-out; /* 更慢 (之前是0.8s) */
}

@keyframes overlap-random {
    0%, 100% { opacity: 0.5; }
    50% { opacity: 0.8; }
}

@keyframes overlap-stable {
    0%, 100% { opacity: 0.6; }
    50% { opacity: 0.7; }
}

@keyframes overlap-conflict {
    0% { opacity: 0.6; transform: scale(1); }
    50% { opacity: 0.9; transform: scale(1.05); }
    100% { opacity: 0.6; transform: scale(1); }
}

/* 性能优化 */
.circle, .label {
    will-change: transform, opacity;
}

/* 确保在透明背景下的可见性 */
.circle {
    stroke: rgba(255, 255, 255, 0.3);
    stroke-width: 1;
}

/* 高对比度模式支持 */
@media (prefers-contrast: high) {
    .circle-stroke {
        stroke-width: 3;
    }
    
    .label {
        font-weight: 800;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.9);
    }
}

/* 减少动画模式支持 */
@media (prefers-reduced-motion: reduce) {
    .circle, .label {
        animation-duration: 0.1s !important;
        transition-duration: 0.1s !important;
    }
}